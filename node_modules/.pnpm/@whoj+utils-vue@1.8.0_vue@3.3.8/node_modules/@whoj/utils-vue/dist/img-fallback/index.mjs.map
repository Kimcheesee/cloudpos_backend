{"version":3,"file":"index.mjs","sources":["../../src/img-fallback/assets.ts","../../src/img-fallback/index.ts"],"sourcesContent":["export const loadingImg = 'data:image/gif;base64,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';\n","import { isVue3 } from 'vue-demi';\nimport type { DirectiveBinding, ObjectDirective, Plugin } from 'vue-demi';\nimport { isObject, isString } from '@whoj/utils-core';\nimport { loadingImg } from './assets';\n\nexport interface ImgFallbackOptions {\n  error?: string;\n  loading?: string;\n}\n\ntype ImgFallbackObjDirective<T extends HTMLImageElement, V extends ImgFallbackOptions | string = ImgFallbackOptions> = ObjectDirective<T, V>;\n\nfunction makeImgFallbackDir<ImgT extends HTMLImageElement, ImgV extends ImgFallbackOptions | string = ImgFallbackOptions>(options: ImgFallbackOptions = {}): ImgFallbackObjDirective<ImgT, ImgV> {\n  return <ImgFallbackObjDirective<ImgT, ImgV>>{\n    [`${isVue3 ? 'beforeMount' : 'bind'}`]: (el: ImgT, binding: DirectiveBinding<ImgV>) => {\n      const { value } = binding;\n      const defaultLoading = options?.loading || loadingImg;\n      const defaultError = options?.error || options?.loading || loadingImg;\n      const img = new Image();\n\n      let loading = defaultLoading;\n      let error = defaultError;\n      const original = el.src;\n\n      if (!value) {\n        console.warn(\n          `Vue Img Fallback Warning: Directive value is ${typeof value}. Now using default values.`\n        );\n      }\n\n      if (isString(value)) {\n        // @ts-ignore\n        loading = error = value;\n      } else if (isObject<ImgFallbackOptions>(value)) {\n        // @ts-ignore\n        loading = value.loading || defaultLoading;\n        // @ts-ignore\n        error = value.error || defaultError;\n      }\n\n      img.src = original;\n\n      el.src = loading;\n\n      img.onload = () => {\n        el.src = original;\n      };\n\n      img.onerror = () => {\n        el.src = error;\n      };\n    }\n  };\n}\n\n/* Creating a directive that can be used in the template. */\nexport const vImgFallback = makeImgFallbackDir<HTMLImageElement>();\n\n// TODO: Add Composable\n// export function useImgFallback<ImgT extends HTMLImageElement>(el: ImgT | Ref<ImgT>, options?: ImgFallbackOptions) {\n//   const imgEl = el instanceof HTMLImageElement ? el : el.value;\n// }\n\n/* A plugin that can be used in Vue. */\nexport const ImgFallback: Plugin = {\n  install(app, options?: ImgFallbackOptions) {\n    app.directive('img-fallback', makeImgFallbackDir<HTMLImageElement, ImgFallbackOptions>(options));\n  }\n};\n"],"names":[],"mappings":";;;;;;;;;AAAO,MAAM,UAAa,GAAA,wlNAAA;;ACY1B,SAAS,kBAAA,CAAiH,OAA8B,GAAA,EAAyC,EAAA;AAC/L,EAA4C,OAAA;AAAA,IAC1C,CAAC,GAAG,MAAS,GAAA,aAAA,GAAgB,MAAM,CAAE,CAAA,GAAG,CAAC,EAAA,EAAU,OAAoC,KAAA;AACrF,MAAM,MAAA,EAAE,OAAU,GAAA,OAAA,CAAA;AAClB,MAAM,MAAA,cAAA,GAAiB,SAAS,OAAW,IAAA,UAAA,CAAA;AAC3C,MAAA,MAAM,YAAe,GAAA,OAAA,EAAS,KAAS,IAAA,OAAA,EAAS,OAAW,IAAA,UAAA,CAAA;AAC3D,MAAM,MAAA,GAAA,GAAM,IAAI,KAAM,EAAA,CAAA;AAEtB,MAAA,IAAI,OAAU,GAAA,cAAA,CAAA;AACd,MAAA,IAAI,KAAQ,GAAA,YAAA,CAAA;AACZ,MAAA,MAAM,WAAW,EAAG,CAAA,GAAA,CAAA;AAEpB,MAAA,IAAI,CAAC,KAAO,EAAA;AACV,QAAQ,OAAA,CAAA,IAAA;AAAA,UACN,CAAA,6CAAA,EAAgD,OAAO,KAAK,CAAA,2BAAA,CAAA;AAAA,SAC9D,CAAA;AAAA,OACF;AAEA,MAAI,IAAA,QAAA,CAAS,KAAK,CAAG,EAAA;AAEnB,QAAA,OAAA,GAAU,KAAQ,GAAA,KAAA,CAAA;AAAA,OACpB,MAAA,IAAW,QAA6B,CAAA,KAAK,CAAG,EAAA;AAE9C,QAAA,OAAA,GAAU,MAAM,OAAW,IAAA,cAAA,CAAA;AAE3B,QAAA,KAAA,GAAQ,MAAM,KAAS,IAAA,YAAA,CAAA;AAAA,OACzB;AAEA,MAAA,GAAA,CAAI,GAAM,GAAA,QAAA,CAAA;AAEV,MAAA,EAAA,CAAG,GAAM,GAAA,OAAA,CAAA;AAET,MAAA,GAAA,CAAI,SAAS,MAAM;AACjB,QAAA,EAAA,CAAG,GAAM,GAAA,QAAA,CAAA;AAAA,OACX,CAAA;AAEA,MAAA,GAAA,CAAI,UAAU,MAAM;AAClB,QAAA,EAAA,CAAG,GAAM,GAAA,KAAA,CAAA;AAAA,OACX,CAAA;AAAA,KACF;AAAA,GACF,CAAA;AACF,CAAA;AAGO,MAAM,eAAe,kBAAqC,GAAA;AAQ1D,MAAM,WAAsB,GAAA;AAAA,EACjC,OAAA,CAAQ,KAAK,OAA8B,EAAA;AACzC,IAAA,GAAA,CAAI,SAAU,CAAA,cAAA,EAAgB,kBAAyD,CAAA,OAAO,CAAC,CAAA,CAAA;AAAA,GACjG;AACF;;;;"}