{"version":3,"file":"useStyleTag.mjs","sources":["../../src/composables/useStyleTag.ts"],"sourcesContent":["// Forked from https://github.com/vueuse/vueuse/blob/main/packages/core/useStyleTag/index.ts\nimport type { Ref } from 'vue-demi';\nimport { readonly, ref, watch } from 'vue-demi';\nimport { tryOnMounted } from './tryOnMounted';\nimport { tryOnScopeDispose } from './tryOnScopeDispose';\nimport type { MaybeRef } from '../types';\nimport { defaultDocument } from '../_configurable';\nimport type { ConfigurableDocument } from '../_configurable';\n\nexport interface UseStyleTagOptions extends ConfigurableDocument {\n  /**\n   * Media query for styles to apply\n   */\n  media?: string;\n\n  /**\n   * Load the style immediately\n   *\n   * @default true\n   */\n  immediate?: boolean;\n\n  /**\n   * Manual controls the timing of loading and unloading\n   *\n   * @default false\n   */\n  manual?: boolean;\n\n  /**\n   * DOM id of the style tag\n   *\n   * @default auto-incremented\n   */\n  id?: string;\n}\n\nexport interface UseStyleTagReturn {\n  id: string;\n  css: Ref<string>;\n  load: () => void;\n  unload: () => void;\n  isLoaded: Readonly<Ref<boolean>>;\n}\n\nlet _id = 0;\n\n/**\n * Inject <style> element in head.\n *\n * Overload: Omitted id\n *\n * @see https://vueuse.org/useStyleTag\n * @param css\n * @param options\n */\nexport function useStyleTag(\n  css: MaybeRef<string>,\n  options: UseStyleTagOptions = {}\n): UseStyleTagReturn {\n  const isLoaded = ref(false);\n\n  const {\n    document = defaultDocument, immediate = true,\n    manual = false,\n    id = `whoj.utils-vue_style_tag_${++_id}`\n  } = options;\n\n  const cssRef = ref(css);\n\n  let stop = () => { };\n  const load = () => {\n    if (!document) {\n      return;\n    }\n\n    const el = (document.getElementById(id) || document.createElement('style')) as HTMLStyleElement;\n\n    if (!el.isConnected) {\n      el.type = 'text/css';\n      el.id = id;\n      if (options.media) {\n        el.media = options.media;\n      }\n      document.head.appendChild(el);\n    }\n\n    if (isLoaded.value) {\n      return;\n    }\n\n    stop = watch(\n      cssRef,\n      (value) => {\n        el.textContent = value;\n      },\n      { immediate: true }\n    );\n\n    isLoaded.value = true;\n  };\n\n  const unload = () => {\n    if (!document || !isLoaded.value) {\n      return;\n    }\n    stop();\n    document.head.removeChild(document.getElementById(id) as HTMLStyleElement);\n    isLoaded.value = false;\n  };\n\n  if (immediate && !manual) {\n    tryOnMounted(load);\n  }\n\n  if (!manual) {\n    tryOnScopeDispose(unload);\n  }\n\n  return {\n    id,\n    css: cssRef,\n    unload,\n    load,\n    isLoaded: readonly(isLoaded)\n  };\n}\n"],"names":[],"mappings":";;;;;;;;;;;AA6CA,IAAI,GAAM,GAAA,CAAA,CAAA;AAWH,SAAS,WACd,CAAA,GAAA,EACA,OAA8B,GAAA,EACX,EAAA;AACnB,EAAM,MAAA,QAAA,GAAW,IAAI,KAAK,CAAA,CAAA;AAE1B,EAAM,MAAA;AAAA,IACJ,QAAW,GAAA,eAAA;AAAA,IAAiB,SAAY,GAAA,IAAA;AAAA,IACxC,MAAS,GAAA,KAAA;AAAA,IACT,EAAA,GAAK,CAA4B,yBAAA,EAAA,EAAE,GAAG,CAAA,CAAA;AAAA,GACpC,GAAA,OAAA,CAAA;AAEJ,EAAM,MAAA,MAAA,GAAS,IAAI,GAAG,CAAA,CAAA;AAEtB,EAAA,IAAI,OAAO,MAAM;AAAA,GAAE,CAAA;AACnB,EAAA,MAAM,OAAO,MAAM;AACjB,IAAA,IAAI,CAAC,QAAU,EAAA;AACb,MAAA,OAAA;AAAA,KACF;AAEA,IAAA,MAAM,KAAM,QAAS,CAAA,cAAA,CAAe,EAAE,CAAK,IAAA,QAAA,CAAS,cAAc,OAAO,CAAA,CAAA;AAEzE,IAAI,IAAA,CAAC,GAAG,WAAa,EAAA;AACnB,MAAA,EAAA,CAAG,IAAO,GAAA,UAAA,CAAA;AACV,MAAA,EAAA,CAAG,EAAK,GAAA,EAAA,CAAA;AACR,MAAA,IAAI,QAAQ,KAAO,EAAA;AACjB,QAAA,EAAA,CAAG,QAAQ,OAAQ,CAAA,KAAA,CAAA;AAAA,OACrB;AACA,MAAS,QAAA,CAAA,IAAA,CAAK,YAAY,EAAE,CAAA,CAAA;AAAA,KAC9B;AAEA,IAAA,IAAI,SAAS,KAAO,EAAA;AAClB,MAAA,OAAA;AAAA,KACF;AAEA,IAAO,IAAA,GAAA,KAAA;AAAA,MACL,MAAA;AAAA,MACA,CAAC,KAAU,KAAA;AACT,QAAA,EAAA,CAAG,WAAc,GAAA,KAAA,CAAA;AAAA,OACnB;AAAA,MACA,EAAE,WAAW,IAAK,EAAA;AAAA,KACpB,CAAA;AAEA,IAAA,QAAA,CAAS,KAAQ,GAAA,IAAA,CAAA;AAAA,GACnB,CAAA;AAEA,EAAA,MAAM,SAAS,MAAM;AACnB,IAAA,IAAI,CAAC,QAAA,IAAY,CAAC,QAAA,CAAS,KAAO,EAAA;AAChC,MAAA,OAAA;AAAA,KACF;AACA,IAAK,IAAA,EAAA,CAAA;AACL,IAAA,QAAA,CAAS,IAAK,CAAA,WAAA,CAAY,QAAS,CAAA,cAAA,CAAe,EAAE,CAAqB,CAAA,CAAA;AACzE,IAAA,QAAA,CAAS,KAAQ,GAAA,KAAA,CAAA;AAAA,GACnB,CAAA;AAEA,EAAI,IAAA,SAAA,IAAa,CAAC,MAAQ,EAAA;AACxB,IAAA,YAAA,CAAa,IAAI,CAAA,CAAA;AAAA,GACnB;AAEA,EAAA,IAAI,CAAC,MAAQ,EAAA;AACX,IAAA,iBAAA,CAAkB,MAAM,CAAA,CAAA;AAAA,GAC1B;AAEA,EAAO,OAAA;AAAA,IACL,EAAA;AAAA,IACA,GAAK,EAAA,MAAA;AAAA,IACL,MAAA;AAAA,IACA,IAAA;AAAA,IACA,QAAA,EAAU,SAAS,QAAQ,CAAA;AAAA,GAC7B,CAAA;AACF;;;;"}